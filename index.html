<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI YouTube Competitor Architect (Gemini 3 Pro)</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --yt-red: #ff0000; --bg: #0f0f0f; --card: #1e1e1e; --text: #fff; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); padding: 15px; }
        .container { max-width: 800px; margin: 20px auto; background: var(--card); padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        #loader {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000; flex-direction: column; align-items: center; justify-content: center;
        }
        .circle { width: 60px; height: 60px; border: 5px solid #333; border-top: 5px solid var(--yt-red); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        h1 { text-align: center; color: var(--yt-red); letter-spacing: -1px; }
        .badge { background: #2a2a2a; color: #aaa; font-size: 10px; padding: 4px 10px; border-radius: 4px; display: inline-block; margin-bottom: 20px; border: 1px solid #444; }
        
        label { display: block; margin-top: 20px; font-weight: 600; color: #ff4d4d; font-size: 13px; text-transform: uppercase; }
        input, textarea { width: 100%; padding: 15px; background: #121212; border: 1px solid #333; border-radius: 10px; color: #fff; margin-top: 8px; box-sizing: border-box; }
        input:focus, textarea:focus { border-color: var(--yt-red); outline: none; }

        .analyze-btn { background: var(--yt-red); color: white; border: none; padding: 20px; width: 100%; border-radius: 12px; font-size: 18px; font-weight: 800; cursor: pointer; margin-top: 25px; transition: 0.2s; }
        .analyze-btn:hover { background: #cc0000; transform: scale(1.01); }

        .result-box { margin-top: 25px; background: #252525; padding: 20px; border-radius: 12px; border-left: 4px solid var(--yt-red); position: relative; }
        .copy-btn { position: absolute; top: 15px; right: 15px; color: #3ea6ff; cursor: pointer; font-size: 12px; font-weight: bold; }
    </style>
</head>
<body>

<div id="loader">
    <div class="circle"></div>
    <p style="margin-top: 20px; font-weight: bold;">Analyzing Viral Patterns...</p>
</div>

<div class="container">
    <h1>YouTube SEO Architect</h1>
    <div class="badge">PRO ENGINE: GEMINI-3-PRO-PREVIEW</div>

    <label>1. Competitor Video URL (Optional but Recommended)</label>
    <input type="text" id="competitorUrl" placeholder="https://www.youtube.com/watch?v=...">

    <label>2. Your Video Topic / Script Idea</label>
    <textarea id="videoTopic" rows="3" placeholder="I am making a video about how to grow a gaming channel in 2025..."></textarea>

    <button class="analyze-btn" onclick="runSEOArchitect()">ANALYZE & GENERATE SEO</button>

    <div class="result-box">
        <span class="copy-btn" onclick="copyText('resTitle')">COPY</span>
        <label>Analyzed High-CTR Title</label>
        <input type="text" id="resTitle" readonly>
    </div>

    <div class="result-box">
        <span class="copy-btn" onclick="copyText('resDesc')">COPY</span>
        <label>Keyword-Rich AI Description</label>
        <textarea id="resDesc" rows="6" readonly></textarea>
    </div>

    <div class="result-box">
        <span class="copy-btn" onclick="copyText('resTags')">COPY</span>
        <label>Extracted Viral Tags</label>
        <input type="text" id="resTags" readonly>
    </div>
</div>

<script>
    async function runSEOArchitect() {
        const topic = document.getElementById('videoTopic').value.trim();
        const competitorUrl = document.getElementById('competitorUrl').value.trim();
        const loader = document.getElementById('loader');

        if (!topic) return alert("Please enter your video topic.");
        loader.style.display = 'flex';

        try {
            // Puter Auto-Login logic
            if (!puter.auth.isSignedIn()) await puter.auth.signIn({ attempt_temp_user_creation: true });

            // Constructing the prompt to include the competitor analysis
            let prompt = `Act as a YouTube Growth Strategist. 
            Step 1: Analyze this target topic: "${topic}".`;
            
            if (competitorUrl) {
                prompt += `\nStep 2: Use your video understanding capabilities to analyze the successful elements of this competitor video: ${competitorUrl}. Extract its high-performing keywords, hook structure, and metadata strategy.`;
            }

            prompt += `\nStep 3: Based on this analysis, generate:
            - A TITLE that is more clickable and keyword-optimized than the competitor.
            - A 200-word SEO DESCRIPTION that includes high-ranking keywords and a call-to-action.
            - 10 SMART TAGS.
            
            Format strictly:
            TITLE: [Title]
            DESC: [Description]
            TAGS: [Tags]`;

            const response = await puter.ai.chat(prompt, { 
                model: 'gemini-3-pro-preview', 
                stream: true 
            });

            let fullText = "";
            for await (const part of response) {
                if (part?.text) fullText += part.text;
            }

            // Parsing output
            document.getElementById('resTitle').value = fullText.split('TITLE:')[1]?.split('DESC:')[0]?.trim() || "Generated Title";
            document.getElementById('resDesc').value = fullText.split('DESC:')[1]?.split('TAGS:')[0]?.trim() || "Generated Description";
            document.getElementById('resTags').value = fullText.split('TAGS:')[1]?.trim() || "#SEO #Viral";

        } catch (err) {
            console.error(err);
            alert("Error: Analysis failed. Please check the URL and try again.");
        } finally {
            loader.style.display = 'none';
        }
    }

    function copyText(id) {
        const el = document.getElementById(id);
        el.select();
        navigator.clipboard.writeText(el.value);
        alert("Metadata copied to clipboard!");
    }
</script>

</body>
</html>
